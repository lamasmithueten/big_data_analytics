% !TEX root =  master.tex
\chapter{Visualisieren der Daten (Phil Richter)}
Nach der Bereinigung und dem Speichern der Daten in einer Datenbank, wie in den vorherigen Kapiteln beschrieben, können die Daten visualisiert werden. Dafür wird als Grundlage
die Programmiersprache Python verwendet. Diese ist vorallem im Bereich der Datenanalyse und -visualisierung sehr weit verbreitet.

Für das Laden und Visualisiern der Daten werden folgende Packages verwendet:
\begin{table}[h!]
    \centering
    \begin{tabularx}{\textwidth}{|c|c|>{\centering\arraybackslash}X|}
        \hline
        \textbf{Package} & \textbf{Version} & \textbf{Beschreibung} \\ \hline
        dotenv & 1.0.1 & Lädt Umgebungsvariablen aus einer \textit{.env} Datei \\ \hline
        sqlalchemy & 2.0.36 & Ermöglicht Zugriff auf die Datenbank, sowie Datenbankabfragen \\ \hline
        pandas & 2.2.3 & Ermöglicht die Manipulation, Analyse und Verarbeitung von Daten \\ \hline
        matplotlib & 3.9.2 & Erstellt aus gegebenen Daten anpassbare Diagramme \\ \hline
        seaborn & 0.13.2 & Basiert auf \textit{matplotlib} und wird ebenfalls zur Datenvisualisierung verwendet \\ \hline
    \end{tabularx}
    \caption{Auflistung aller verwendeten Packages, sowie ihrer Versionen}
\end{table}

\section{Laden der Daten}
Im ersten Schritt der Visualisieren werden die Daten aus der Datenbank geladen. Dafür werden die Datenbankverbindungsinformationen mit Hilfe von \textit{dotenv}
aus einer lokal definierten \textit{.env} Datei geladen. Anschließend wird mit \textit{sqlalchemy} eine Verbindung zur Datenbank aufgebaut und die Daten werden 
mit einer SQL-Querry abgefragt. Die abgefrageten Daten werden in einem \textit{pandas} DataFrame gespeichert. Ein DataFrame ist dabei eine zweidimensionale Datenstruktur,
wie eine Tabelle. Im folgendem Python-Code werden die Daten wie beschrieben geladen:

\lstset{
	breaklines=true,         % Enable line wrapping
	breakatwhitespace=false, % Allow breaks at any character (not just whitespace)
	basicstyle=\ttfamily,    % Use monospaced font
}

\begin{lstlisting}[caption={\texttt{visualization.ipynb}},captionpos=b]
    import os
    import re
    import numpy as np
    import pandas as pd
    import seaborn as sn
    import matplotlib.pyplot as plt
    from sqlalchemy import create_engine
    from dotenv import load_dotenv

    load_dotenv() # load environment variables

    # get the environment variables
    b_user = os.getenv("DB_USER")
    db_password = os.getenv("DB_PASSWORD")
    db_name = os.getenv("DB_NAME")
    db_host = os.getenv("DB_HOST")
    db_port = os.getenv("DB_PORT")

    db_url = f"postgresql://{db_user}:{db_password}@{db_host}:{db_port}/{db_name}" # create the db url
    engine = create_engine(db_url)

    query = "SELECT * FROM intel;" # query to get the data from the database
    df = pd.read_sql(query, engine) # store the data in a dataframe
\end{lstlisting}

\section{Bereinigen der Daten}